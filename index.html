<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>Guardi√£ Rural Pro</title>
    
    <style>
        :root {
            --azul: #2D46B9;
            --amarelo: #E9C143;
            --verde: #34a853;
            --bg: #f2f2f7;
            --card: #ffffff;
            --safe-top: env(safe-area-inset-top);
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

        body { 
            font-family: -apple-system, system-ui, sans-serif; 
            background-color: var(--bg); 
            margin: 0; 
            /* Espa√ßo para o cabe√ßalho din√¢mico */
            padding-top: calc(var(--safe-top) + 160px); 
            transition: padding-top 0.3s ease;
        }

        /* CABE√áALHO GLASSMORPHISM */
        header { 
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(15px); -webkit-backdrop-filter: blur(15px);
            position: fixed; top: 0; width: 100%; z-index: 1000;
            padding-top: var(--safe-top);
            box-shadow: 0 1px 10px rgba(0,0,0,0.05);
        }

        .logo-bar { display: flex; align-items: center; justify-content: space-between; padding: 10px 15px; }
        .logo-img { height: 45px; width: auto; }
        .btn-stats { 
            background: var(--azul); color: white; border: none; 
            padding: 8px 12px; border-radius: 20px; font-size: 11px; font-weight: 800;
            display: flex; align-items: center; gap: 5px;
        }

        .search-area { padding: 0 15px 10px 15px; }
        #searchBar {
            width: 100%; padding: 12px 15px; border-radius: 12px;
            border: none; background: rgba(0,0,0,0.05); font-size: 16px; outline: none;
            transition: background 0.2s;
        }
        #searchBar:focus { background: rgba(0,0,0,0.08); }

        /* DASHBOARD MODERNO */
        #dashboard {
            display: none; background: white; padding: 15px;
            border-bottom: 1px solid #ddd; animation: slideDown 0.3s ease-out;
        }
        @keyframes slideDown { from { opacity:0; transform: translateY(-10px); } to { opacity:1; transform: translateY(0); } }
        
        .stat-grid { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 8px; margin-bottom: 15px; }
        .stat-card { background: #f8f9fa; padding: 10px; border-radius: 10px; text-align: center; border-bottom: 3px solid var(--azul); }
        .stat-card.solar { border-bottom-color: var(--amarelo); }
        .stat-num { display: block; font-size: 18px; font-weight: 900; color: var(--azul); }
        .stat-label { font-size: 9px; font-weight: 800; color: #666; text-transform: uppercase; }

        /* CATEGORIAS */
        .categories {
            display: flex; overflow-x: auto; padding: 5px 15px 12px; gap: 8px;
            scrollbar-width: none;
        }
        .categories::-webkit-scrollbar { display: none; }
        .pill {
            padding: 8px 16px; border-radius: 20px; background: #e5e5ea;
            border: none; color: #3a3a3c; font-size: 11px; font-weight: 800;
            white-space: nowrap; transition: 0.2s;
        }
        .pill.active { background: var(--azul); color: white; transform: scale(1.05); }

        /* GRADE DE BOT√ïES */
        .grid {
            display: grid; grid-template-columns: repeat(auto-fill, minmax(80px, 1fr));
            gap: 12px; padding: 15px; max-width: 600px; margin: 0 auto;
        }

        .btn {
            aspect-ratio: 1/1; background: var(--azul); 
            border: 2px solid var(--amarelo); border-radius: 18px; 
            font-size: 22px; font-weight: 900; color: white; 
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1); transition: 0.1s;
        }
        .btn-solar { background: var(--amarelo) !important; color: var(--azul) !important; border-color: var(--azul) !important; }
        .btn-solar::after { content: '‚òÄÔ∏è'; font-size: 10px; margin-top: 2px; }
        
        .btn:active { transform: scale(0.9); opacity: 0.8; }

        /* MODAL ESTILO IPHONE */
        #modal {
            display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.6); z-index: 2000; align-items: flex-end; 
        }
        .modal-box {
            background: white; width: 100%; padding: 25px 20px calc(25px + env(safe-area-inset-bottom));
            border-radius: 30px 30px 0 0; text-align: center;
            animation: slideUp 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        @keyframes slideUp { from { transform: translateY(100%); } to { transform: translateY(0); } }

        .tech-tag-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin: 15px 0; }
        .tech-tag { background: #f2f2f7; padding: 12px; border-radius: 15px; text-align: center; }
        .tech-tag b { display: block; font-size: 16px; color: var(--azul); }
        .tech-tag small { font-size: 10px; font-weight: 800; color: #8e8e93; text-transform: uppercase; }

        .maps-link {
            display: flex; align-items: center; justify-content: center; gap: 10px;
            background: var(--verde); color: white; text-decoration: none;
            padding: 16px; border-radius: 16px; font-weight: 800; margin-bottom: 12px;
            box-shadow: 0 5px 15px rgba(52,168,83,0.3);
        }

        .close-btn { background: #f2f2f7; color: #3a3a3c; border: none; padding: 14px; border-radius: 16px; width: 100%; font-weight: 800; }
        .hidden { display: none !important; }
    </style>
</head>
<body>

<header id="header">
    <div class="logo-bar">
        <img src="logo.png" alt="Logo" class="logo-img">
        <button class="btn-stats" onclick="toggleDash()">üìä PROJETO</button>
    </div>

    <div id="dashboard">
        <div class="stat-grid">
            <div class="stat-card"><span class="stat-num">312</span><span class="stat-label">Equipamentos</span></div>
            <div class="stat-card"><span class="stat-num">51</span><span class="stat-label">C√¢meras PTZ</span></div>
            <div class="stat-card"><span class="stat-num">99</span><span class="stat-label">C√¢meras LPR</span></div>
            <div class="stat-card"><span class="stat-num">162</span><span class="stat-label">Anal√≠ticas</span></div>
            <div class="stat-card solar"><span class="stat-num">54</span><span class="stat-label">Postes Solares</span></div>
            <div class="stat-card"><span class="stat-num">3</span><span class="stat-label">Pontaletes</span></div>
        </div>
    </div>

    <div class="search-area">
        <input type="text" id="searchBar" placeholder="Pesquisar ponto ou refer√™ncia..." onkeyup="filtrar()">
    </div>

    <div class="categories">
        <button class="pill active" onclick="filtrarCat('TUDO', this)">TUDO</button>
        <button class="pill" onclick="filtrarCat('ESTRADA DA PRODU√á√ÉO', this)">PRODU√á√ÉO</button>
        <button class="pill" onclick="filtrarCat('MG 308', this)">MG 308</button>
        <button class="pill" onclick="filtrarCat('BR 365', this)">BR 365</button>
        <button class="pill" onclick="filtrarCat('BR 135', this)">BR 135</button>
    </div>
</header>

<div class="grid" id="mainGrid"></div>

<div id="modal" onclick="fechar(event)">
    <div class="modal-box" onclick="event.stopPropagation()">
        <div style="width: 40px; height: 5px; background: #ddd; border-radius: 5px; margin: 0 auto 15px;"></div>
        <div id="m-dir" style="font-size: 11px; font-weight: 800; color: var(--azul); letter-spacing: 1px;"></div>
        <div id="m-ref" style="font-size: 22px; font-weight: 900; margin: 5px 0 20px; text-transform: uppercase;"></div>
        
        <div class="tech-tag-grid">
            <div class="tech-tag"><small>PTZ</small><b id="m-ptz"></b></div>
            <div class="tech-tag"><small>LPR</small><b id="m-lpr"></b></div>
            <div class="tech-tag"><small>Anal√≠tica</small><b id="m-ana"></b></div>
            <div class="tech-tag"><small>Pontaletes</small><b id="m-pont"></b></div>
            <div class="tech-tag" style="grid-column: span 2;" id="solar-tag"><small>Energia</small><b id="m-solar"></b></div>
        </div>

        <a id="maps-url" href="" target="_blank" class="maps-link">üìç VER NO GOOGLE MAPS</a>
        <button class="close-btn" onclick="fechar()">FECHAR</button>
    </div>
</div>

<script>
    const pontosRural = {
        "1": {ref: "EUROFARMA", g: "-16.643067,-43.814701", pont: 0, ptz: 1, ana: 4, lpr: 2, s: "N"},
        "2": {ref: "KRE. PRODU√á√ÉO", g: "-16.661129,-43.810569", pont: 0, ptz: 1, ana: 4, lpr: 2, s: "N"},
        "3": {ref: "KRE. PRODU√á√ÉO", g: "-16.671169,-43.771169", pont: 0, ptz: 1, ana: 4, lpr: 2, s: "N"},
        "4": {ref: "SAMBAIA", g: "-16.652512,-43.779147", pont: 1, ptz: 1, ana: 4, lpr: 2, s: "S"},
        "5": {ref: "KRE. PRODU√á√ÉO", g: "-16.634123,-43.752391", pont: 0, ptz: 1, ana: 4, lpr: 2, s: "N"},
        "6": {ref: "RIO CANABRAVA", g: "-16.642123,-43.782531", pont: 0, ptz: 1, ana: 4, lpr: 2, s: "S"},
        "7": {ref: "TREVO CAPIT√ÉO EN√âAS", g: "-16.655123,-43.812312", pont: 0, ptz: 1, ana: 4, lpr: 2, s: "N"},
        "8": {ref: "TREVO FAZENDA BARREIRO", g: "-16.631257,-43.832174", pont: 0, ptz: 1, ana: 4, lpr: 2, s: "N"},
        "9": {ref: "KRE. PRODU√á√ÉO", g: "-16.592581,-43.682531", pont: 0, ptz: 1, ana: 4, lpr: 2, s: "S"},
        "10.1": {ref: "S√ÉO PEDRO DA GAR√áA", g: "-16.174354,-43.865721", pont: 0, ptz: 1, ana: 2, lpr: 2, s: "N"},
        "10.2": {ref: "S√ÉO PEDRO DA GAR√áA", g: "-16.171364,-43.864249", pont: 0, ptz: 1, ana: 3, lpr: 2, s: "N"},
        "10.3": {ref: "S√ÉO PEDRO DA GAR√áA", g: "-16.170329,-43.866304", pont: 0, ptz: 1, ana: 3, lpr: 2, s: "N"},
        "11.1": {ref: "APARECIDA DO MUNDO NOVO", g: "-16.115268,-43.924987", pont: 0, ptz: 1, ana: 3, lpr: 2, s: "N"},
        "11.2": {ref: "APARECIDA DO MUNDO NOVO", g: "-16.115054,-43.926347", pont: 0, ptz: 1, ana: 4, lpr: 2, s: "N"},
        "11.3": {ref: "APARECIDA DO MUNDO NOVO", g: "-16.113743,-43.928035", pont: 0, ptz: 1, ana: 3, lpr: 2, s: "N"},
        "12": {ref: "SAMAMBAIA", g: "-16.499812,-43.256812", pont: 0, ptz: 1, ana: 4, lpr: 2, s: "N"},
        "13": {ref: "CH√ÅCARA RECANTO VIT√ìRIA", g: "-16.732387,-43.765477", pont: 0, ptz: 1, ana: 4, lpr: 2, s: "N"},
        "14": {ref: "PONTO 17", g: "-16.711234,-43.758012", pont: 0, ptz: 1, ana: 4, lpr: 2, s: "S"},
        "15.1": {ref: "VIASOLO ENG.", g: "-16.80261,-43.74253", pont: 1, ptz: 0, ana: 2, lpr: 2, s: "N"},
        "15.2": {ref: "VIASOLO ENG.", g: "-16.802308,-43.742994", pont: 0, ptz: 1, ana: 0, lpr: 0, s: "N"},
        "15.3": {ref: "VIASOLO ENG.", g: "-16.802445,-43.742443", pont: 1, ptz: 0, ana: 2, lpr: 2, s: "N"},
        "16": {ref: "ENTRADA S√ÉO GERALDO 2", g: "-16.708266,-43.906155", pont: 0, ptz: 1, ana: 4, lpr: 2, s: "N"},
        "17": {ref: "POSTO BARRAL 2", g: "-16.698212,-43.896123", pont: 0, ptz: 1, ana: 4, lpr: 2, s: "N"},
        "18.1": {ref: "ENTRADA CANTO DO ENGENHO", g: "-16.856596,-44.053928", pont: 0, ptz: 1, ana: 3, lpr: 3, s: "S"},
        "18.2": {ref: "CANTO DO ENGENHO", g: "-16.908136,-44.072303", pont: 0, ptz: 1, ana: 3, lpr: 1, s: "N"},
        "19": {ref: "CALHAU", g: "-16.698123,-43.871234", pont: 1, ptz: 1, ana: 4, lpr: 2, s: "N"},
        "20": {ref: "PR√ìXIMO A TIM BAR", g: "-16.624293,-43.905645", pont: 0, ptz: 1, ana: 4, lpr: 2, s: "N"},
        "21.1": {ref: "NOVA ESPERAN√áA", g: "-16.591795,-43.939539", pont: 0, ptz: 1, ana: 3, lpr: 2, s: "N"},
        "21.2": {ref: "NOVA ESPERAN√áA", g: "-16.583996,-43.938143", pont: 0, ptz: 1, ana: 4, lpr: 3, s: "N"},
        "21.3": {ref: "NOVA ESPERAN√áA", g: "-16.583171,-43.939690", pont: 0, ptz: 1, ana: 4, lpr: 2, s: "N"},
        "21.4": {ref: "NOVA ESPERAN√áA", g: "-16.579846,-43.939828", pont: 0, ptz: 1, ana: 4, lpr: 2, s: "N"},
        "21.5": {ref: "NOVA ESPERAN√áA", g: "-16.581552,-43.932128", pont: 0, ptz: 1, ana: 3, lpr: 2, s: "N"},
        "22": {ref: "VALE DOS IP√äS", g: "-16.485678,-43.951231", pont: 0, ptz: 1, ana: 4, lpr: 2, s: "N"},
        "23.1": {ref: "ERMIDINHA", g: "-16.430596,-44.088530", pont: 0, ptz: 1, ana: 4, lpr: 2, s: "N"},
        "23.2": {ref: "ERMIDINHA", g: "-16.426618,-44.092428", pont: 0, ptz: 1, ana: 2, lpr: 2, s: "N"},
        "23.3": {ref: "ERMIDINHA", g: "-16.432924,-44.090728", pont: 0, ptz: 1, ana: 4, lpr: 0, s: "N"},
        "24.1": {ref: "PEDRA PRETA", g: "-16.397228,-44.146957", pont: 0, ptz: 1, ana: 2, lpr: 1, s: "N"},
        "24.2": {ref: "PEDRA PRETA", g: "-16.400718,-44.148533", pont: 0, ptz: 1, ana: 2, lpr: 1, s: "N"},
        "25.1": {ref: "S√ÉO JO√ÉO DA VEREDA", g: "-16.700472,-44.114599", pont: 0, ptz: 1, ana: 3, lpr: 1, s: "N"},
        "25.2": {ref: "S√ÉO JO√ÉO DA VEREDA", g: "-16.701558,-44.114982", pont: 0, ptz: 1, ana: 4, lpr: 0, s: "N"},
        "25.3": {ref: "S√ÉO JO√ÉO DA VEREDA", g: "-16.702478,-44.114267", pont: 0, ptz: 1, ana: 4, lpr: 1, s: "N"},
        "26": {ref: "MIRALTA", g: "-16.531023,-43.952381", pont: 0, ptz: 1, ana: 4, lpr: 2, s: "N"},
        "27.1": {ref: "VILA NOVA", g: "-16.459359,-43.866763", pont: 0, ptz: 1, ana: 4, lpr: 2, s: "N"},
        "27.2": {ref: "VILA NOVA", g: "-16.460815,-43.867670", pont: 0, ptz: 1, ana: 4, lpr: 2, s: "N"},
        "28": {ref: "PANOR√ÇMICA", g: "-16.478612,-43.996111", pont: 0, ptz: 1, ana: 4, lpr: 2, s: "N"},
        "29.1": {ref: "SANTA ROSA", g: "-16.353900,-43.965950", pont: 0, ptz: 1, ana: 2, lpr: 2, s: "N"},
        "29.2": {ref: "SANTA ROSA", g: "-16.347114,-43.963303", pont: 0, ptz: 1, ana: 4, lpr: 0, s: "N"},
        "29.3": {ref: "SANTA ROSA", g: "-16.345021,-43.963812", pont: 0, ptz: 1, ana: 2, lpr: 2, s: "N"},
        "30": {ref: "LAGOINHA", g: "-16.379412,-44.002812", pont: 0, ptz: 1, ana: 4, lpr: 2, s: "N"},
        "31.1": {ref: "PLANALTO", g: "-16.895852,-43.867733", pont: 0, ptz: 1, ana: 2, lpr: 0, s: "N"},
        "31.2": {ref: "PONTALETE", g: "-16.896464,-43.867820", pont: 1, ptz: 0, ana: 2, lpr: 2, s: "N"},
        "32.1": {ref: "CAMPOS EL√çSEOS", g: "-16.662308,-43.767341", pont: 0, ptz: 1, ana: 4, lpr: 3, s: "N"},
        "32.2": {ref: "CAMPOS EL√çSEOS", g: "-16.640891,-43.746476", pont: 0, ptz: 1, ana: 3, lpr: 2, s: "N"},
        "33": {ref: "JARDIM ALEGRIA", g: "-16.295812,-44.071231", pont: 0, ptz: 1, ana: 4, lpr: 2, s: "N"}
    };

    function toggleDash() {
        const dash = document.getElementById('dashboard');
        const header = document.getElementById('header');
        if (dash.style.display === 'block') {
            dash.style.display = 'none';
            document.body.style.paddingTop = 'calc(var(--safe-top) + 160px)';
        } else {
            dash.style.display = 'block';
            document.body.style.paddingTop = 'calc(var(--safe-top) + 330px)';
        }
    }

    function getDirecao(idStr) {
        const id = parseFloat(idStr);
        if (id >= 1 && id < 13) return "ESTRADA DA PRODU√á√ÉO";
        if (id >= 13 && id < 16) return "MG 308";
        if (id >= 16 && id < 20) return "BR 365";
        if (id >= 20 && id <= 33) return "BR 135";
        return "OUTROS";
    }

    function render() {
        let html = '';
        Object.keys(pontosRural).sort((a,b) => parseFloat(a)-parseFloat(b)).forEach(key => {
            const p = pontosRural[key];
            const solarClass = (p.s === "S") ? "btn-solar" : "";
            html += `<button class="btn ${solarClass}" data-dir="${getDirecao(key)}" data-ref="${p.ref}" onclick="ver('${key}')">${key}</button>`;
        });
        document.getElementById('mainGrid').innerHTML = html;
    }

    function ver(id) {
        if (navigator.vibrate) navigator.vibrate(50);
        const p = pontosRural[id];
        document.getElementById('m-ref').innerText = p.ref;
        document.getElementById('m-dir').innerText = getDirecao(id);
        document.getElementById('m-ptz').innerText = p.ptz;
        document.getElementById('m-lpr').innerText = p.lpr;
        document.getElementById('m-ana').innerText = p.ana;
        document.getElementById('m-pont').innerText = p.pont;
        document.getElementById('m-solar').innerText = p.s === "S" ? "POSTE SOLAR" : "CONVENCIONAL";
        document.getElementById('solar-tag').style.background = p.s === "S" ? "#fff9c4" : "#f2f2f7";
        document.getElementById('maps-url').href = `https://www.google.com/maps/search/?api=1&query=${p.g}`;
        document.getElementById('modal').style.display = "flex";
    }

    function fechar(e) { 
        if (!e || e.target === document.getElementById('modal') || e.target.className === 'close-btn') {
            document.getElementById('modal').style.display = "none";
        }
    }

    function filtrar() {
        const t = document.getElementById('searchBar').value.toUpperCase();
        document.querySelectorAll('.btn').forEach(btn => {
            const match = btn.getAttribute('data-ref').toUpperCase().includes(t) || btn.innerText.includes(t);
            btn.classList.toggle('hidden', !match);
        });
    }

    function filtrarCat(cat, el) {
        document.querySelectorAll('.pill').forEach(p => p.classList.remove('active'));
        el.classList.add('active');
        document.querySelectorAll('.btn').forEach(btn => {
            if (cat === 'TUDO') btn.classList.remove('hidden');
            else btn.classList.toggle('hidden', btn.getAttribute('data-dir') !== cat);
        });
    }

    render();
</script>
</body>
</html>
